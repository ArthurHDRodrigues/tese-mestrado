\chapter{Avaliação empírica}
\label{sec:avaliacao-empirica}

Nesse capítulo faremos experimentos comparativos para avaliar a eficiência do algoritmo de conexidade dinâmica elaborado no Capítulo~\ref{sec:connDG}. Como esse algoritmo foi desenvolvido  por Holm, de Lichtenberg e Thorup, ele é conhecido na literatura pelo acrônimo~\HDT.

Desde sua invenção, houveram três estudos experimentais desse algoritmo~\cite{EmpiricalStudy1997, EmpiricalStudy2002, Zaroliagis2002}.
O principal algoritmo concorrente foi desenvolvido por Henzinger e King, denotado por~\HK.
Ele empata o consumo assintótico amortizado esperado de $\O{\lg^2 n}$ de~\HDT.

Ambos os algoritmos visam manter uma floresta geradora do grafo dinâmico para realizar o teste de conexidade e usam a mesma estratégia de atribuir níveis às arestas do grafo para amortizar o custo das operações.

A principal diferença entre eles é que~\HK{} sorteia arestas reservas e as testa para verificar se substituem uma aresta removida da MSF. Portanto seu consumo de tempo é necessariamente esperado, enquanto que~\HDT{} pode ser completamente determinístico se a implementação das florestas dinâmicas usadas for determinística. 


\NEW{
Na literatura, houveram os seguintes estudos comparativos~\cite{EmpiricalStudy1997, EmpiricalStudy2002, Zaroliagis2002}.


O estudo~\cite{EmpiricalStudy1997} não analisa~\HDT{} e somente compara~\HK{} com um algoritmo desenvolvido por~Eppstein et al.~\cite{Eppstein1992SparsificationaTF} que utiliza uma técnica chamada esparsificação para reduzir o custo assintótico das operações aplicadas ao grafo.

O estudo~\cite{EmpiricalStudy1997} conclui que~\HK{} se torna mais eficiente do que o algoritmo de Eppstein et al. quando o número de atualizações aplicadas a um grafo dinâmico é aproximadamente duas vezes o número de vértices do grafo. Esse fenômeno é devido à amortização utilizada por~\HK{}, que necessita de um número razoável de atualizações para diluir o custo das operações. 

}

\begin{comment}

\section{Breve descrição de~\CLHB{}}


Em $2022$, Chen \textit{et al.}\cite{QC22} propõem uma heurística para garantir baixo consumo de tempo da consulta de conexidade. Nessa capítulo denotaremos esse algoritmo por~\CLHB.
Assim como~\HDT e~\HK, \CLHB{} mantém uma floresta geradora~$F$ do grafo dinâmico para fazer os testes de conexidade.
No entanto, em~\CLHB{}, essa floresta é enraizada.
Para manter essa floresta, é usada uma árvore enraizada $k$-ária.
Cada vértice~$v$ de~$F$ é representado por exatamente um nó que possui os campos: pai, filhos, tam.\TODO{Confirmar quais campos}

O campo pai é um ponteiro que indica o pai de~$v$. O nó que representa a raiz de~$F$ possui~\Nil{} como valor do campo pai.
O campo filhos é uma tabela de símbolos que armazena um ponteiro para cada nó que representa um vértices incidente a~$v$.


Os autores não apresentam análises de complexidade das operações, mas comparam o desempenho da nova estrutura de dados com a de Henzinger e King em bancos de dados imensos bem conhecidos. No entanto, não comparam sua implementação com outros algoritmos, como o de Holm et al.
\end{comment}

\section{Metodologia}

\NEW{
Em nossos experimentos, faremos testes com conjuntos de dados reais e artificiais.
A tabela~\ref{tab:datasets} lista os conjuntos de dados reais que usaremos e algumas características dos mesmos.

Como podemos ver na tabela~\ref{tab:datasets}, cada conjunto de dados possui um número variado de atualizações.
Além disso, esses conjuntos de dados listam somente inserções de arestas.
}


\begin{table}
\begin{center}
\begin{tabular}{ |c|c|c|c| } 
 \hline
	Nome & $|V|$ & $|E|$ & N° de atualizações\\
 \hline
	email-dnc (DNC)\cite{nr-aaai15}&$1.9\times 10^3$&$3.74\times 10^4$&$3.2\times 10^4$\\
 \hline
	Call (CA)\cite{nr-aaai15}&$7\times 10^3$&$5.1\times 10^4$&$2.3\times 10^4$\\
 \hline
	messages (MS)\cite{nr-aaai15}&$2\times 10^3$&$6\times 10^4$&$6.3\times 10^4$\\
 \hline
	FB-FORUM (FB)\cite{nr-aaai15}&$8.99\times 10^2$&$3.5\times 10^4$&$3.8\times 10^4$\\
 \hline
	Wiki-elec(WI)\cite{nr-aaai15}&$7.1\times 10^3$&$1.07\times 10.5$&$2.1\times 10^5$\\
 \hline
	tech-as-topology(Tech)\cite{nr-aaai15}&$3.4\times 10^4$&$1.71\times 10^5$&$2.7\times 10^5$\\
 \hline
	Enron(EN)\cite{nr-aaai15}&$8.7\times 10^4$&$1.1\times 10^6$&$1.28\times 10^6$\\
 \hline
\end{tabular}
\caption{Tabela com conjuntos de dados usados retirados de~\cite{nr-aaai15}}
\label{tab:datasets}
\end{center}
\end{table}



\section{Resultados}


\newpage

\subsection{Inserção de aresta de arestas reservas}
\legenda
\begin{figure}
\tabela{csv/call/updates/call_insertion_nte.csv}{Call}{insertionCall}
\tabela{csv/dnc/updates/dnc_insertion_nte.csv}{DNC}{QueryDNC}
\tabela{csv/enron/updates/enron_insertion_nte.csv}{EN}{QueryENRON}
\tabela{csv/fb/updates/fb_insertion_nte.csv}{FB}{QueryFB}
\tabela{csv/messages/updates/messages_insertion_nte.csv}{MS}{QueryMS}
\tabela{csv/tech/updates/tech_insertion_nte.csv}{Tech}{QueryTech}
\tabela{csv/wiki/updates/wiki_insertion_nte.csv}{WI}{QueryWiki}
\caption{Performance de inserção de arestas reservas}
\end{figure}



\newpage
\subsection{Inserção de aresta de arestas da árvore}
\legenda
\begin{figure}
\tabela{csv/call/updates/call_insertion_te.csv}{Call}{insertionCall}
\tabela{csv/dnc/updates/dnc_insertion_te.csv}{DNC}{QueryDNC}
\tabela{csv/enron/updates/enron_insertion_te.csv}{EN}{QueryENRON}
\tabela{csv/fb/updates/fb_insertion_te.csv}{FB}{QueryFB}
\tabela{csv/messages/updates/messages_insertion_te.csv}{MS}{QueryMS}
\tabela{csv/tech/updates/tech_insertion_te.csv}{Tech}{QueryTech}
\tabela{csv/wiki/updates/wiki_insertion_te.csv}{WI}{QueryWiki}
\caption{Performance de inserção de arestas da árvore}
\end{figure}

\newpage
\subsection{Remoção de aresta de arestas reservas}
\legenda
\begin{figure}
\tabela{csv/call/updates/call_insertion_nte.csv}{Call}{insertionCall}
\tabela{csv/dnc/updates/dnc_deletion_nte.csv}{DNC}{QueryDNC}
\tabela{csv/enron/updates/enron_deletion_nte.csv}{EN}{QueryENRON}
\tabela{csv/fb/updates/fb_deletion_nte.csv}{FB}{QueryFB}
\tabela{csv/messages/updates/messages_deletion_nte.csv}{MS}{QueryMS}
\tabela{csv/tech/updates/tech_deletion_nte.csv}{Tech}{QueryTech}
\tabela{csv/wiki/updates/wiki_deletion_nte.csv}{WI}{QueryWiki}
\caption{Performance de inserção de arestas reservas}
\end{figure}


\newpage
\subsection{Remoção de aresta de arestas da árvore}
\legenda
\begin{figure}
\tabela{csv/call/updates/call_insertion_te.csv}{Call}{insertionCall}
\tabela{csv/dnc/updates/dnc_deletion_te.csv}{DNC}{QueryDNC}
\tabela{csv/enron/updates/enron_deletion_te.csv}{EN}{QueryENRON}
\tabela{csv/fb/updates/fb_deletion_te.csv}{FB}{QueryFB}
\tabela{csv/messages/updates/messages_deletion_te.csv}{MS}{QueryMS}
\tabela{csv/tech/updates/tech_deletion_te.csv}{Tech}{QueryTech}
\tabela{csv/wiki/updates/wiki_deletion_te.csv}{WI}{QueryWiki}
\caption{Performance de inserção de arestas da árvore}
\end{figure}


\newpage
\subsection{Consultas de conexidade}
\legenda
\begin{figure}
\tabela{csv/call/query_call.csv}{Call}{QueryCall}
\tabela{csv/dnc/query_dnc.csv}{DNC}{QueryDNC}
\tabela{csv/enron/query_enron.csv}{EN}{QueryEN}
\tabela{csv/fb/query_fb.csv}{FB}{QueryFB}
\tabela{csv/messages/query_messages.csv}{MS}{QueryMS}
\tabela{csv/tech/query_tech.csv}{Tech}{QueryTech}
\tabela{csv/wiki/query_wiki.csv}{WI}{QueryWiki}
\caption{Performance da consulta de conexidade}
\end{figure}


\section{Sensibilidade a diâmetro}
\begin{figure}
\begin{tikzpicture}
    \begin{axis}[
		 ylabel=tempo médio (s),
		 %xticklabel=\empty,
		 xlabel=\empty,
		 xlabel=pontos de testes,
		 %scaled x ticks=false,
		 width=0.5\linewidth,
	         ]
    \addplot[orange] table [x=avg_sp, y=Dtree, col sep=comma] {csv/avg_sp.csv};
	    \label{pgfplots:Dtree:avgsp}
    \addplot[black] table [x=avg_sp, y=HK, col sep=comma] {csv/avg_sp.csv};
	    \label{pgfplots:HK:avgsp}
    \addplot[blue] table [x=avg_sp, y=HDT, col sep=comma] {csv/avg_sp.csv};
	    \label{pgfplots:HDT:avgsp}
\end{axis}
\end{tikzpicture}
\end{figure}
